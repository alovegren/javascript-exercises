<!doctype html>
<html>
  <head></head>
  <body>
    <form method="post" action="/api/staff_members">
      <p><label for="email">Email: <input type="email" name="email"></label></p>
      <p><label for="email">Name: <input type="text" name="name"></label></p>
      <p><input type="submit"></p>
    </form>
    <script>
      function multiPartToJSON(formData) {
        let json = {};

        for (let entry of formData.entries()) {
          json[entry[0]] = entry[1]
        }

        return json;
      }
  
      let form = document.querySelector('form');
  
      form.addEventListener('submit', event => {
        event.preventDefault();
  
        const data = new FormData(form);
        let jsonData = JSON.stringify(multiPartToJSON(data));
        
        const request = new XMLHttpRequest();
        request.open('POST', form.action);
        request.setRequestHeader('Content-Type', 'application/json');

        request.addEventListener('load', event => {
          event.preventDefault();
          let status = request.status;

          if (status === 201) {
            let id = JSON.parse(request.response).id;
            alert(`Staff member with id ${id} was added.`);
          } else {
            alert(request.responseText);
          }
        });

        request.send(jsonData);
      });
    </script>
  </body>
</html>